// Some JS must-have's. https://github.com/svexican/js-extras 

//
//
var slice=[].slice;String.prototype.toBoolean=function(){return"true"===this.valueOf()?!0:"false"===this.valueOf()?!1:void 0},String.prototype.closest_in=function(t,e){if(("undefined"==typeof utils||null===utils)&&null==utils.levenshtein)throw Error("utils.levenshtein is not defined");return t.filter(function(t){return function(n){return utils.levenshtein(t,n)<=e}}(this))},String.prototype.capitalise=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.regExpEscape=function(){return this.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},String.prototype.format=function(){var t,e,n,r;for(t=1<=arguments.length?slice.call(arguments,0):[],r=this,e=t.length;e;)e-=1,n=new RegExp("\\{"+e+"\\}","gm"),r=r.replace(n,t[e]);return r},String.prototype.camelise=function(){return this.replace(/(?:^|[-_])(\w)/g,function(t,e){return e?e.toUpperCase():""})};

//
//
var indexOf=[].indexOf||function(t){for(var r=0,n=this.length;n>r;r++)if(r in this&&this[r]===t)return r;return-1};Array.prototype.first=function(){return this[0]},Array.prototype.last=function(){return this[this.length-1]},Array.prototype.count=function(){return this.length},Array.prototype.empty=function(){return 0===this.length},Array.prototype.head=function(){return this[0]},Array.prototype.tail=function(){return Array.prototype.slice.call(this,1)},Array.prototype.transpose=function(t,r){var n;return this.length<t+1||this.length<r+1?this:(n=this[t],this[t]=this[r],this[r]=n,this.splice(this.length,0),this)},Array.prototype.shuffle=function(){var t,r,n,i,e;for(t=n=i=this.length-1;1>=i?1>=n:n>=1;t=1>=i?++n:--n)r=Math.floor(Math.random()*(t+1)),e=[this[r],this[t]],this[t]=e[0],this[r]=e[1];return this},Array.prototype.unique=function(){var t,r,n,i,e;for(n=new Object,t=r=0,i=this.length;i>=0?i>r:r>i;t=i>=0?++r:--r)n[this[t]]=this[t];return function(){var r;r=[];for(t in n)e=n[t],r.push(e);return r}()},Array.prototype.difference=function(t){return this.filter(function(r){return indexOf.call(t,r)<0})},Array.prototype.intersection=function(t){return this.filter(function(r){return indexOf.call(t,r)>=0})},Array.prototype.union=function(t){return this.difference(t).concat(t)},Array.prototype.remove=function(t){var r,n,i,e;for(n=i=0,e=this.length;e>i;n=++i)if(r=this[n],r===t)return this.splice(n,1);return void 0},Array.prototype.humanPrint=function(t,r,n){var i,e;return n=n||void 0,0===this.length?n:1===this.length?this[0]:(e=this.slice(-1)[0],i=this.slice(0,-1).join((t||",")+" "),i+(" "+(r||"&")+" ")+e)},Array.prototype.indexOf_p=function(t,r){var n,i,e,o;for(i=e=0,o=this.length;o>e;i=++e)if(n=this[i],n[t]===r)return i},Array.prototype.filter_p=function(t,r){return this.filter(function(n){return n[t]===r})},Array.prototype.filter_firstp=function(t,r){return this.filter_p(t,r)[0]},Array.prototype.unique_p=function(t){var r,n,i,e,o,u,h;for(e=new Object,n=i=0,o=this.length;o>=0?o>i:i>o;n=o>=0?++i:--i)e[this[n][t]]=this[n];u=[];for(r in e)h=e[r],u.push(h);return u},Array.prototype.remove_p=function(t,r){var n,i,e,o;for(i=e=0,o=this.length;o>e;i=++e)if(n=this[i],n[t]===r)return this.splice(i,1);return void 0},Array.prototype.difference_p=function(t,r){return this.filter(function(n){var i;return i=n[r],indexOf.call(t.map(function(t){return t[r]}),i)<0})},Array.prototype.union_p=function(t,r){return this.differenceBy(t,r).concat(t)},Array.prototype.sort_p=function(t,r,n){var i;return i=function(){var i;return i=n?function(r){return n(r[t])}:function(r){return r[t]},function(t,n){var e,o;return e=i(t),o=i(n),[-1,1][+!!r]*((e>o)-(o>e))}},this.sort(i())},Array.prototype.group_p=function(t){var r,n,i,e;for(e=new Object,n=0,i=this.length;i>n;n++){if(r=this[n],"undefined"==typeof r[t])throw'AttributeError: Cannot read property "'+t+'" of '+r;e[r[t]]instanceof Array?e[r[t]].push(r):e[r[t]]=[r]}return e};

//
//
Object.defineProperty(Object.prototype,"merge",{enumerable:!1,value:function(e){var r,t;for(r in e)t=e[r],this[r]=t;return this}});

//
//
Date.prototype.prettyHTML=function(t,e){var a,s,n,r,i;return t=t||["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e=e||["January","February","Mach","April","May","June","July","August","September","October","November","December"],a=new Date(this.getTime()+6e4*this.getTimezoneOffset()),n=e[a.getMonth()],s=a.getDate()<10?"&nbsp;"+a.getDate():""+a.getDate(),i=a.getFullYear(),r=t[a.getDay()].substr(0,3),"<span style='font-family: monospace'> "+n+" "+s+", "+i+" <span style='color: #aaaaaa'>("+r+")</span> </span>"},Date.prototype.standardDate=function(){var t,e,a;return e=this.getMonth()<9?"0"+(this.getMonth()+1):""+(this.getMonth()+1),t=this.getDate()<10?"0"+this.getDate():""+this.getDate(),a=this.getFullYear(),a+"-"+e+"-"+t},Date.prototype.standardDateTime=function(){var t,e,a,s,n;return s=this.getMonth()<9?"0"+(this.getMonth()+1):""+(this.getMonth()+1),t=this.getDate()<10?"0"+this.getDate():""+this.getDate(),e=this.getHours()<10?"0"+this.getHours():""+this.getHours(),a=this.getMinutes()<10?"0"+this.getMinutes():""+this.getMinutes(),n=this.getFullYear(),n+"-"+s+"-"+t+" "+e+":"+a},Date.prototype.fix_dashes=function(t){return t.replace(/(\d{4})-(\d{2})-(\d{2})/gi,"$1/$2/$3")};

//
//
var utils,slice=[].slice;utils={fnRun:function(){var n,l;return l=arguments[0],n=2<=arguments.length?slice.call(arguments,1):[],"function"==typeof l?l.apply(void 0,n):void 0},levenshtein:function(n,l){var e,t,i,u,r,o,f,s,a,d,g,c,h,p,w,v,y,m;if(o=n.length,f=l.length,0===o)return f;if(0===f)return o;for(e=new Array,t=u=0,c=o;c>=0?c>=u:u>=c;t=c>=0?++u:--u){for(m=[],i=r=0,h=f;h>=0?h>=r:r>=h;i=h>=0?++r:--r)m.push(0);e.push(m)}for(t=s=1,p=o;p>=1?p>=s:s>=p;t=p>=1?++s:--s)e[t][0]=t;for(i=a=1,w=f;w>=1?w>=a:a>=w;i=w>=1?++a:--a)e[0][i]=i;for(i=d=1,v=f;v>=1?v>=d:d>=v;i=v>=1?++d:--d)for(t=g=1,y=o;y>=1?y>=g:g>=y;t=y>=1?++g:--g)e[t][i]=n[t-1]===l[i-1]?e[t-1][i-1]:Math.min(e[t-1][i]+1,e[t][i-1]+1,e[t-1][i-1]+1);return e[o][f]}},"undefined"!=typeof global&&null!==global&&(global.utils=utils),"undefined"!=typeof window&&null!==window&&(window.utils=utils);